javascript:(function(){var STORAGE_KEY='boothLibraryData';var stored=localStorage.getItem(STORAGE_KEY);var allData=stored?JSON.parse(stored):[];var items=[];var links=document.querySelectorAll('a');var itemUrls=[];for(var i=0;i<links.length;i++){if(links[i].href&&(links[i].href.includes('/items/')||links[i].href.includes('booth.pm/ja/items/'))){itemUrls.push(links[i])}}for(var i=0;i<itemUrls.length;i++){try{var link=itemUrls[i];var url=link.href;var isDuplicate=false;for(var d=0;d<allData.length;d++){if(allData[d].boothUrl===url){isDuplicate=true;break}}if(isDuplicate)continue;var title='';var container=link.closest('.flex.gap-8')||link.closest('div');if(container){var titleElements=container.querySelectorAll('a[href*="/items/"]');for(var t=0;t<titleElements.length;t++){var titleText=titleElements[t].textContent.trim();if(titleText&&titleText.length>2&&!titleText.includes('http')){title=titleText;break}}if(!title){var allTextNodes=container.querySelectorAll('*');for(var n=0;n<allTextNodes.length;n++){var nodeText=allTextNodes[n].textContent.trim();if(nodeText&&nodeText.length>5&&!nodeText.includes('http')&&!nodeText.includes('.')&&!nodeText.includes('/')&&!nodeText.includes('@')){title=nodeText;break}}}if(!title){var containerText=container.textContent.replace(/\s+/g,' ').trim();var lines=containerText.split(' ');for(var l=0;l<lines.length;l++){if(lines[l].length>3&&!lines[l].includes('.')&&!lines[l].includes('/')&&!lines[l].includes('@')){title=lines[l];break}}}}if(!title)title='商品'+(i+1);var container=link.closest('.mb-16.bg-white')||link.closest('.mb-16')||link.closest('div')||link.closest('li')||link.closest('article')||link.parentElement;var thumbnail='';if(container){var imgs=container.querySelectorAll('img');for(var j=0;j<imgs.length;j++){if(imgs[j].src&&(imgs[j].src.includes('pximg')||imgs[j].src.includes('booth'))){thumbnail=imgs[j].src;break}}}var author='';var shopUrl='';if(container){var shopLinks=container.querySelectorAll('a');for(var k=0;k<shopLinks.length;k++){if(shopLinks[k].href&&shopLinks[k].href.includes('.booth.pm/')&&shopLinks[k].href!==url){shopUrl=shopLinks[k].href;author=shopLinks[k].textContent.trim();break}}}var zipFiles=[];if(container){var html=container.innerHTML||'';var textContent=container.textContent||'';var zipMatches1=html.match(/[\w\-_.()【】\[\]０-９Ａ-Ｚａ-ｚ\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+\.(zip|unitypackage|rar|7z)/gi)||[];var zipMatches2=textContent.match(/[\w\-_.()【】\[\]０-９Ａ-Ｚａ-ｚ\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+\.(zip|unitypackage|rar|7z)/gi)||[];var allZips=zipMatches1.concat(zipMatches2);for(var z=0;z<allZips.length;z++){var zipName=allZips[z].replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>');if(zipFiles.indexOf(zipName)===-1&&zipName.toLowerCase().indexOf('icon')===-1&&zipName.toLowerCase().indexOf('thumb')===-1&&zipName.toLowerCase().indexOf('resized')===-1){zipFiles.push(zipName)}}}items.push({title:title,boothUrl:url,thumbnailUrl:thumbnail,author:author,shopUrl:shopUrl,zipFiles:zipFiles,downloadHints:zipFiles,extractedAt:new Date().toISOString(),page:parseInt(new URL(window.location.href).searchParams.get('page')||'1')})}catch(e){}}allData=allData.concat(items);localStorage.setItem(STORAGE_KEY,JSON.stringify(allData));var hasNext=document.querySelector('a[rel="next"]')||document.querySelector('a[href*="page="]');var nextPageNum=parseInt(new URL(window.location.href).searchParams.get('page')||'1')+1;if(!hasNext){var nextLinks=document.querySelectorAll('a');for(var n=0;n<nextLinks.length;n++){if(nextLinks[n].href&&nextLinks[n].href.includes('page='+nextPageNum)){hasNext=nextLinks[n];break}}}var totalZips=0;for(var t=0;t<allData.length;t++){if(allData[t].zipFiles)totalZips+=allData[t].zipFiles.length}var statusDiv=document.getElementById('boothStatus')||document.createElement('div');statusDiv.id='boothStatus';statusDiv.style.cssText='position:fixed;top:20px;right:20px;z-index:99999;background:#1e40af;color:white;padding:15px 20px;border-radius:8px;font-family:Arial,sans-serif;box-shadow:0 4px 12px rgba(0,0,0,0.3);max-width:300px;';statusDiv.innerHTML='<div style="font-weight:bold;margin-bottom:5px;">📚 Booth収集中</div><div>このページ: '+items.length+'件</div><div>合計: '+allData.length+'件</div><div>ZIPファイル: '+totalZips+'件</div>';if(!document.getElementById('boothStatus')){document.body.appendChild(statusDiv)}if(hasNext){statusDiv.innerHTML+='<div style="margin-top:10px;color:#fbbf24;"><strong>次のページに移動してブックマークレットを再実行してください</strong></div>';setTimeout(function(){statusDiv.remove()},10000)}statusDiv.innerHTML+='<div style="margin-top:10px;"><strong>エクスポートはいつでも可能</strong></div>';var exportBtn=document.createElement('button');exportBtn.textContent='エクスポート';exportBtn.style.cssText='background:#059669;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;font-weight:bold;margin-top:10px;';exportBtn.onclick=function(){var exportData={exportedAt:new Date().toISOString(),totalItems:allData.length,totalZipFiles:totalZips,source:'booth-library-production',data:allData};var json=JSON.stringify(exportData,null,2);var blob=new Blob([json],{type:'application/json'});var url=(window.URL||window.webkitURL).createObjectURL(blob);var a=document.createElement('a');a.href=url;a.download='booth_library_'+new Date().toISOString().split('T')[0]+'.json';document.body.appendChild(a);a.click();document.body.removeChild(a);(window.URL||window.webkitURL).revokeObjectURL(url);alert('エクスポート完了！'+allData.length+'件');statusDiv.remove()};statusDiv.appendChild(exportBtn)})();